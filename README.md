# MachineLearning
# 머신러닝기초지식

(참고. 김승연&정용주, 처음배우는 머신러닝, 2017, 한빛미디어)

# 머신러닝
- <b>데이터를 이용해서 명시적으로 정의되지 않은 패턴을 컴퓨터로 학습하여 결과를 만들어내는 학문 분야</b>
- 머신러닝 = 데이터 + 패턴인식 + 컴퓨터를 이용한 계산

### 데이터
- 머신러닝은 항상 데이터를 기반으로 함(통계학과 가깝다)
- 알고리즘이 아닌 데이터 학습을 통해 실행 동작이 바뀜

### 패턴인식
- 통계학을 비롯해 딥러닝을 이용하여 데이터의 패턴을 유추하는 방법이 주축이 됨
    - 딥러닝은 통계학에서 사용하는 전통적인 방법과는 다른 방법을 사용하지만 '패턴을 찾아내려고 학습한다'는 점에서 그 목표는 동일하다.
- <b>데이터를 보고 패턴을 추리는 것</b>이 머신러닝의 핵심

### 컴퓨터를 이용한 계산
- 머신러닝은 데이터를 처리하고 패턴을 학습하고 계산하는 데 컴퓨터를 사용
- 계산 속도를 높이고, 더 많은 데이터를 효율적으로 다루고자 많은 연구가 이루어짐
    - ex. 분산처리, 시스템 구성
- 머신러닝은 실제 데이터에 대해 계산해서 결과를 만들어낸다는 점에서 전산학의 한 분야로 볼 수 있다.

## 배경지식
### 패턴인식에서 쓰이는 수학적 배경지식
1. 선형대수
    - 행렬 연산(특히 행렬곱)
    - 역행렬 개념
    - <b>행렬 분해(특잇값 분해)</b>
2. 미분
    - 최솟값/최댓값
    - 1차 미분함수
    - <b>미적분학, 최적화</b>
3. 통계학
    - 정상분포, 가우스분포
    - 상관관계, 회귀
4. 확률
    - <b>확률의 정의, 조건부 확률</b>

### 프로그래밍
- 기본적인 파이썬 문법
- 함수 사용
- 파일 사용법

## 머신러닝 변천사
- 현재의 딥러닝은 신경망 기반과 통계 기반의 머신러닝, 빅데이터가 통합된 것이다.

### 현재
- 현재의 머신러닝은 대량의 데이터를 바탕으로 하는 딥러닝 기법을 주로 사용
    - 예시1. 성격이 다른 데이터를 연관시켜서 데이터를 더 효율적으로 사용하는 딥러닝 구조의 개발(비디오에 있는 자막과 이미지를 동시에 학습시키거나 영어, 프랑스어, 스페인어를 동시에 학습시키기)
    - 예시2. 통계학적 머신러닝의 기법을 조합해 데이터를 더 효율적으로 사용하는 딥러닝(원샷, 제로샷 러닝) 기술의 발전
    - 예시3. 머신러닝, 특히 딥러닝을 거대 규모로 빠르게 연산할 수 있는 시스템의 발전(하드웨어, 소프트웨어 모두)
    - 예시4. 딥러닝의 더 효율적인 학습을 위한 기술(드롭아웃, 비동기 SGD등)의 발전
    - 예시5. 데이터에 대한 더 큰 관심으로 인해 양적, 질적으로 크게 성장한 데이터 수집 기술의 발전
 
## 제이슨 아이스너의 머신러닝의 3가지 관점

1. 통찰력(좋은 사전 지식)
    - 시작점: 데이터에 대한 지식
    - 결과: 데이터에 대한 믿음
    - 대표적인 기법으로는 <b>Bayesian(베이지안) 기법</b>이 있다.
2. 이론적 엄정성(잘 정의되고 보장된 모델)
    - 시작점: 증명이 가능한 수학 이론
    - 결과: 잘 정의되고 보장된 성능
    - 머신러닝 알고리즘이 어느 정도의 성능을 보장하고, 거대한 스케일의 데이터를 얼마나 쉽게 다루며, 잘못될 확률이 얼마나 적은지에 대한 해답을 구하는 부분
    - 대표적인 기법으로는 <b>spectral learning, support vector machine, convex optimization(볼록 최적화)</b>이 있다.
3. 데이터 적합성(높은 가능도)
    - 시작점: 많은 데이터
    - 결과: 데이터에 잘 맞는 모델
    - 데이터에 대한 지식이 희박한 경우/데이터가 아주 많아서 기존 지식 없이도 머신러닝 기법이 잘 동작하는 상황을 가정한다. <- 이 경우는 노이즈의 영향을 많이 받으므로 보다 많은 데이터를 이용하여 노이즈의 영향을 줄이는 기술이 많이 쓰인다.
        - 딥러닝/랜덤 포레스트가 여기에 해당함(모델이 수학적으로 간단해서 구현하기 쉽고 스케일을 키우기 좋음)
    - 이건 빈도론자(frequentist)에 대응하는 부분임

# 머신러닝의 분류
1. 지도학습
2. 비지도학습
3. 강화학습

- 풀어내는 방법에 따라 딥러닝 or 통계로 분류할 수 있음

### 지도학습
- 주어진 데이터와 레이블(정답)을 이용해서 <b>미지의 상태나 값을 예측</b>하는 학습 방법
- 예시
    - 예전의 주식 시장 변화를 보고 내일의 주식 시장 변화 예측하기
    - 문서에 사용된 단어를 보고 해당 문서의 카테고리 분류하기
    - 사용자가 구매한 상품을 토대로 다음에 구입할 상품 예측하기

### 비지도학습
- 데이터 자체에서 유용한 패턴을 찾아내는 학습 방법
- 예시
    - 비슷한 데이터끼리 묶는 군집화
    - 데이터에서 이상한 점을 찾아내는 이상 검출
    - 데이터 분포 추측

### 강화학습
- 기계(에이전트)와 환경과의 상호작용(선택과 피드백의 반복)을 통해 장기적으로 얻는 이득을 최대화하도록 하는 학습 방법
- 지도학습과 달리, 강화학습은 입력값-출력값(레이블)의 쌍이 명시적으로 정해지지 않음
- 예시
    - 바둑에서 현재 판에서 다음 수를 선택하는 것을 학습하는 과정을 지도학습// 그런데 다음 수만을 고려하는 게 아니라 게임 승패까지의 전체 수를 고려하여 게임에서 이길 경우 점수를 받고 그렇지 않으면 점수를 받지 못하도록 하여 일련의 이기는 수를 학습하는 과정이 강화학습임
    - 화성 탐사 로봇이 경로는 탐색하는 과정, 지구에서는 화성에 관한 데이터를 얻을 수 없으므로, 로봇은 실제로 환경이 어떤지에 대한 정보가 거의 없다. 따라서 어디로 갈지를 판단하고자 할 떄,<b>'현재 가진 정보를 이용해 다음 행동 정하기'(이를 exploitation이라 함)</b>와 <b>'새로운 정보를 얻기 위해 가보지 않은 곳 가기'(이를 exploration이라 함)</b> 중에서 하나를 선택해야하는데, 강화학습은 각각의 행동에 대한 피드백을 받아서 다음 행동을 정하는 알고리즘을 학습해나감
 
## 지도학습
- 지도학습은 세부적으로 어떤 것을 예측하느냐에 따라 회귀, 분류, 랭킹으로 구분할 수 있다.

### 회귀와 분류
- 지도학습의 경우 <b>데이터를 통해 학습하는 레이블이 어떤 성질을 지니는지</b>에 따라서 크게 <b>regression(회귀)</b>와 <b>classification(분류)</b>로 구분

#### 회귀
- 회귀의 경우에는 숫자값을 예측함(보통 연속된 숫자를 예측)
    - 예시. 기존 온도 추이를 보고 내일 온도를 예측하는 일

#### 분류
- 입력 데이터들을 주어진 항목들로 나누는 방법
    - 예시. 어떤 문서가 도서관 어떤 분류에 해당하는지 고르는 경우

회귀와 분류는 서로를 통해 서로를 구현할 수 있을만큼 유사하다.
- 예시1. 어제의 온도와 구름의 양으로 내일의 날씨가 좋을지 안 좋을지 예측하는 분류 시스템.
    - 날씨가 좋을 경우를 1, 날씨가 나쁠 경우를 0으로 두어 회귀를 이용하여 날씨가 좋을 확률을 0부터 1 사이의 값으로 구하고 0.8이상이면 좋음, 아니면 나쁨으로 분류할 수 있다.
- 예시2. 반대로 데이터를 받았을 때 먼저 분류를 구현한 다음, 그 분류에 따라서 연속적인 숫자값을 예측하는 방법
    - 사용자 그룹을 '행복한 사용자', '보통 사용자', '불행한 사용자'로 일차 분류한 다음, '사용자 기분'이라는 연속적인 숫자값을 각각의 그룹에 (+1, 0, -1과 같은 식으로) 부여하면 분류를 이요해서 회귀한 것이 됨 

그렇지만 수학적으로 더 간단하게 정의되는 '회귀'가 머신러닝의 더 기본적인 도구로 쓰인다.


## 추천 시스템과 랭킹학습
### 추천 시스템
- 추천시스템은 상품에 대한 사용자 선호도(별점, 구매 여부 등)를 예측하는 시스템임
- 상품과 사용자 데이터를 이용하여 값 혹은 레이블을 예측하는 것이므로 회귀의 일종으로 볼 수 있지만, 기법과 세팅이 특이해서 따로 분류하겠음

- 예시. 온라인 동호회에서 영화를 추천한다고 가정
    - 각 영화에 대한 평점데이터를 이용하여 아직 평점이 없는 영화 점수를 예측하고 그중 가장 점수가 높은 영화를 추천하는 방식을 취할 수 있다.
    - <b>회귀와 다른 점</b>은 입력과 출력이 아니라 <b>관객과 영화, 관객과 점수 등 다양한 관계를 고려한다는 점</b>이다.

### 랭킹학습
- 데이터의 순위를 예측(회귀에서처럼 각 입력 데이터의 출력값을 예측하는 것이 아님)
- 예시.
    - 영화 평점을 가지고 특정 관객이 각 영화에 대해 몇 점을 줄지 예측하는 것은 <b>회귀</b>.
    - 좋아할 만한 영화 10편을 추천한다면 <b>랭킹학습</b>

## 비지도학습
- 지도학습과 달리 데이터를 직접 모델링하는 기법, 군집화, 토픽 모델링, 밀도 추정, 차원축소 등의 기법이 있다.

### 군집화와 토픽 모델링
#### 군집화(clustering)
- 비지도학습의 분류 중 하나로 비슷한 데이터들을 묶어서 큰 단위로 만드는 기법
- 즉 비슷한 데이터들을 묶어서 몇 개의 그룹을 만들어 데이터 패턴을 파악함
- 예시. 신문 기사를 수집하여 군집화를 적용하면 비슷한 내용의 기사가 스포츠 클러스터 혹은 경제 클러스터 등으로 묶이게 됨

#### 토픽 모델링(topic modeling)
- 군집화와 매우 유사하지만, 주로 텍스트 데이터에 대해 사용됨
- 토픽 모델링은 보통 한 문서가 토픽에 따라 만들어지고 그에 따라 단어가 생성되어 문서가 쓰여진다는 가정하에 접근한다.(군집화는 더 일반적인 데이터에 해당되기 때문에 가정의 성격이 크게 다름)

또한 많은 군집화 기법이 문서 하나를 클러스터 하나로 분류하지만, 토픽 모델링은 일반적으로 관련 정도를 확률로 표현함(예시. 0.5 스포츠, 0.4 연예, 0.1 경제)

### 밀도 추정(density estimation)
- 관측한 데이터로부터 데이터를 생성한 원래의 분포를 추측하는 방법
- 예시. 각국의 학생들의 키와 몸무게를 모아놓은 통계 자료에서 키와 몸무게의 관계를 분석할 때, 단순히 각각의 경우에 해당하는 데이터 수를 세는 방법도 있지만, 여러가지 다른 기법으로 더 정확한 분포를 얻을 수도 있다.
- 대표적인 기법.
    - kernel density estimation, 커널 밀도 추정
    - Gaussian mixture model, 가우스 혼합 모델

### 차원축소(dimensionality reduction)
- 데이터의 차원을 낮추는 기법
- 보통 데이터가 복잡하고 높은 차원을 가져서 시각화하기 어려울 때 2차원이나, 3차원으로 표현하기 위해 사용함
- 일반적으로 주요 패턴을 찾아서 해당 패턴을 낮은 차원에서 보존하는 방식으로 이루어짐
- 이 기법은 독립적으로 쓰이기도 하지만, 데이터에 적합한 머신러닝 기법을 찾는 데이터 분석 초기 단계에 적용하기도 함
- 대표적인 기법
    - PCA(주성분 분석)
    - 특잇값 분해

## 딥러닝
- 딥러닝은 신경망을 층층이 쌓아서 문제를 해결하는 기법의 총칭
- 머신러닝이 풀고자 하는 목표에 따라 분류한 개념이 아니며, 사용하는 기법이 특정 형태를 가지는 것을 말함
- 즉 지도학습, 비지도학습을 딥러닝을 이용해서 풀 수도 있고, 통계학적인 방법을 이용해서 풀 수도 있다.

- 딥러닝은 데이터양에 의존하는 기법으로, 다른 머신러닝 기법보다 문제에 대한 가정이 적은 대신 다양한 패턴과 경우에 유연하게 대응하는 구조를 만들어 많은 데이터를 이용하여 학습시키는 것으로 모델의 성능을 향상시킨다.(큰 데이터에서 잘 작동함)
